<html ng-app="myApp">
	<head>
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

		<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
		
		<script src='https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-beta.17/angular.min.js'></script>
		<script src='https://cdn.firebase.com/js/client/1.0.15/firebase.js'></script>
		<script src='https://cdn.firebase.com/libs/angularfire/0.8.0/angularfire.min.js'></script>
	</head>
	<body ng-controller="MyController">
		<!-- CHAT MARKUP -->
		<div class="jumbotron">
			<header>Firebase Chat Demo</header>

			<div>
				<label for="nameInput">Username:</label>
				<input ng-model="name" type="text" id="nameInput" placeholder="enter a username...">
			</div>

			<ul>
				<li ng-repeat="msg in messages">
					<strong>{{msg.from}}</strong>
					{{msg.body}}
				</li>
			</ul>

			<footer>
				<input ng-model="msg" ng-keydown="addMessage($event)" type="text" id="messageInput"  placeholder="Type a message...">
			</footer>
		</div>


		<script>
			var myApp = angular.module("myApp", ["firebase"]);

			myApp.controller('MyController', ['$scope', '$firebase',
				function($scope, $firebase) {
					var ref = new Firebase("https://playwithfire.firebaseIO.com/");
					$scope.messages = $firebase(ref).$asArray();

					//ADD MESSAGE METHOD
					$scope.addMessage = function(e) {

						//LISTEN FOR RETURN KEY
						if (e.keyCode === 13 && $scope.msg) {
							//ALLOW CUSTOM OR ANONYMOUS USER NAMES
							var name = $scope.name || 'anonymous';

							// add msg
							$scope.messages.$add({from: name, body: $scope.msg});

							//RESET MESSAGE
							$scope.msg = "";
						}
					}
				}
			]);
		</script>
	</body>
</html>